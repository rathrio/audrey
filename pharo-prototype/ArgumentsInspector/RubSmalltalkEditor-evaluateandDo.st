'From Pharo6.0 of 13 May 2016 [Latest update: #60546] on 26 October 2018 at 9:12:11.925297 am'!!RubSmalltalkEditor methodsFor: 'do-its' stamp: 'Radi 10/25/2018 16:18'!evaluate: aStream andDo: aBlock	"Treat the current selection as an expression; evaluate it and invoke aBlock with the result."	| result rcvr ctxt method methodId argumentSet |		(self model interactionModel respondsTo: #methodWidget) 		ifTrue: [ 			method := self model interactionModel methodWidget methodsSelection first.			methodId := method methodClass asString , '>>#' , method selector.			argumentSet := ArgumentsCollector data at: methodId ifAbsent: [ Set new ].			(argumentSet isEmpty) ifFalse: [ argumentSet inspect. ^ nil. ] ].	(self model respondsTo: #doItReceiver) 		ifTrue: [ rcvr := self model doItReceiver.				ctxt := self model doItContext]		ifFalse: [ rcvr := ctxt := nil].	result := rcvr class compiler			source: aStream;			context: ctxt;			receiver: rcvr;			requestor: self morph  "don't set it to self.. The receiver can be destroyed as a result of evaluateSelection";			failBlock:  [self morph flash. ^ nil];			evaluate.					^ aBlock value: result! !